jQuery(document).ready(function(e){function t(t,i){if("show"===t){let t='<div class="epkb-admin-dialog-box-loading"><div class="epkb-admin-dbl__header"><div class="epkb-admin-dbl-icon epkbfa epkbfa-hourglass-half"></div>'+(i?'<div class="epkb-admin-text">'+i+"</div>":"")+'</div></div><div class="epkb-admin-dialog-box-overlay"></div>';e("body").append(t)}else"remove"===t&&(e(".epkb-admin-dialog-box-loading").remove(),e(".epkb-admin-dialog-box-overlay").remove())}function i(e,t,i){return'<div class="eckb-bottom-notice-message"><div class="contents"><span class="'+i+'">'+(e?"<h4>"+e+"</h4>":"")+(t||"")+"</span></div></div>"}let a=e("#epkb-config-wizard-content");if(a.length<=0)return;let n=e(".epkb-admin__error-form__container");a.find(".epkb-setup-wizard-button-apply").on("click",function(a){let o=[],s={action:"epkb_apply_setup_wizard_changes",_wpnonce_epkb_ajax_action:e("#_wpnonce_epkb_ajax_action").val(),epkb_wizard_kb_id:e("#epkb_wizard_kb_id").val(),sidebar:"0"},r=e('input[name="epkp-theme"]:checked').val();void 0===r&&(r="current"),e(".epkb-menu-checkbox input[type=checkbox]:checked").length&&e(".epkb-menu-checkbox input[type=checkbox]:checked").each(function(){o.push(e(this).prop("name").split("epkb_menu_")[1])}),e(".epkb-setup-wizard-sidebar input[type=radio]:checked").length&&(s.sidebar=e(".epkb-setup-wizard-sidebar input[type=radio]:checked").eq(0).val()),s.theme_name=r,s.kb_name=e(".epkb-wizard-name input").val(),s.kb_slug=e(".epkb-wizard-slug input").val(),s.menu_ids=o,function(a,o,s,r,p=!1){let d,c;o=void 0===o?"epkb_callback_noop":o,e.ajax({type:"POST",dataType:"json",data:a,url:ajaxurl,beforeSend:function(e){p||t("show",r)}}).done(function(e){(c=e||"").error||void 0===c.message?d=c.message?c.message:i("",epkb_vars.reload_try_again,"error"):c.redirect_to_url&&c.redirect_to_url.length>0&&(window.location=c.redirect_to_url)}).fail(function(e,t,a){d=a?" ["+a+"]":epkb_vars.unknown_error,d=i(epkb_vars.error_occurred+". "+epkb_vars.msg_try_again,d,"error")}).always(function(){p||t("remove",""),d?(e(n).find(".epkb-admin__error-form__title").text(epkb_vars.setup_wizard_error_title),e(n).find(".epkb-admin__error-form__desc").text(epkb_vars.setup_wizard_error_desc),e(n).find("#epkb-admin__error-form__message").val(e(d).text().trim()),e(n).css("display","block","important")):"function"==typeof o?o(c=void 0===c?"":c):s&&location.reload()})}(s)}),a.find(".epkb-setup-wizard-button-next, .epkb-setup-wizard-button-prev").on("click",function(t){t.preventDefault();let i=Number(e(this).val());e(".epkb-wsb-step").removeClass("epkb-wsb-step--active"),e("#epkb-wsb-step-"+i).addClass("epkb-wsb-step--active"),e(".epkb-wc-step-panel").removeClass("epkb-wc-step-panel--active"),e(".epkb-wc-step-panel-button").removeClass("epkb-wc-step-panel-button--active"),e("#epkb-wsb-step-"+i+"-panel").addClass("epkb-wc-step-panel--active"),e(".epkb-wsb-step-"+i+"-panel-button").addClass("epkb-wc-step-panel-button--active"),e(".epkb-wizard-top-bar").show(),e(".epkb-setup-wizard-theme-header__info__title[data-title-id]").length&&(e(".epkb-setup-wizard-theme-header__info__title[data-title-id]").addClass("hidden"),e(".epkb-setup-wizard-theme-header__info__title[data-title-id="+i+"]").removeClass("hidden")),function(t){a.find(".epkb-wizard-status-bar .epkb-wsb-step").removeClass("epkb-wsb-step--completed"),a.find(".epkb-wizard-status-bar .epkb-wsb-step").each(function(){let i=e(this).attr("id");i[i.length-1]<t&&e(this).addClass("epkb-wsb-step--completed")})}(i),e("html, body").animate({scrollTop:0},0)}),e(".epkb-setup-option__option__label").on("click",function(){e(".epkb-setup-option-container").removeClass("epkb-setup-option-container--active"),e(this).closest(".epkb-setup-option-container").addClass("epkb-setup-option-container--active")}),e("#epkb-wsb-step-3-panel .epkb-setup-option__featured-img-container").on("click",function(){e(this).closest(".epkb-setup-option__selection").find("label").trigger("click")}),e('.epkb-wizard-slug input[type="text"]').on("input",function(){e("#epkb-wizard-slug-target").text(e(this).val())}),a.find(".eckb-wizard-step-2 .epkb-setup-option__featured-img-container").on("click",function(t){t.preventDefault(),t.stopPropagation(),a.find(".image_zoom").remove();var i,n=e(this).find("img");i=n.length>1?e(n[0]).is(":visible")?e(n[0]).attr("src"):e(n[1]).is(":visible")?e(n[1]).attr("src"):e(n[2]).attr("src"):e(this).find("img").attr("src"),e(this).after('<div id="epkb_image_zoom" class="image_zoom"><img src="'+i+'" class="image_zoom"><span class="close epkbfa epkbfa-close"></span></div>'),e("html, body").on("click",function(){e("#epkb_image_zoom").remove(),e("html, body").off("click")})}),e(document).on("click",".epkb-close-notice",function(){e(this).parent().addClass("fadeOutDown")}),e(n).on("click",".epkb-close-notice, .epkb-admin__error-form__btn-cancel",function(){window.location=epkb_vars.need_help_url}),e(n).find("#epkb-admin__error-form").on("submit",function(t){t.preventDefault();let i=e(this);t.data;e.ajax({type:"POST",dataType:"json",url:ajaxurl,data:i.serialize(),beforeSend:function(t){e(n).find("input, textarea").prop("disabled","disabled"),e(n).find(".epkb-admin__error-form__response").html(epkb_vars.sending_error_report)}}).done(function(t){void 0!==t.success&&0==t.success?e(n).find(".epkb-admin__error-form__response").html(t.data):void 0!==t.success&&1==t.success?e(n).find(".epkb-admin__error-form__response").html(t.data):e(n).find(".epkb-admin__error-form__response").html(epkb_vars.send_report_error)}).fail(function(t,i,a){e(n).find(".epkb-admin__error-form__response").html(epkb_vars.send_report_error)}).always(function(){e(n).find("input, textarea").prop("disabled",!1),setTimeout(function(){window.location=epkb_vars.need_help_url},1e3)})}),e(document).on("click",".epkb-notice-dismiss",function(t){t.preventDefault(),e("#"+e(this).data("notice-id")).slideUp();var i={action:"epkb_dismiss_ongoing_notice",epkb_dismiss_id:e(this).data("notice-id")};e.ajax({type:"POST",dataType:"json",url:ajaxurl,data:i})})});